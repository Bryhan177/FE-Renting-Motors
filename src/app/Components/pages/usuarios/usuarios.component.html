<div class="min-h-screen bg-gray-900 text-white p-6 rounded-xl">
  
  <!-- Encabezado -->
  <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
    <div>
      <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">
        Gesti√≥n de Usuarios
      </h1>
      <p class="text-gray-400 mt-1">Administra conductores, empleados y roles</p>
    </div>
    <div class="flex gap-3">
        <button (click)="toggleVistaReportes()" 
            class="flex items-center gap-2 bg-gray-800 hover:bg-gray-700 text-gray-300 border border-gray-700 font-medium py-2.5 px-5 rounded-lg transition">
            <span>{{ vistaReportes ? 'üë• Ver Lista' : 'üìä Ver Reportes' }}</span>
        </button>
        <button (click)="abrirModal()" 
            class="flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 px-5 rounded-lg transition shadow-lg shadow-blue-500/20">
            <span>‚ûï</span> Nuevo Usuario
        </button>
    </div>
  </div>

  <!-- Vista REPORTES (Dashboard de usuarios) -->
  <div *ngIf="vistaReportes">
     <!-- Aqu√≠ ir√≠an los reportes copiados o redise√±ados del template original, pero estilizados -->
     <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
            <h3 class="text-gray-400 text-sm font-semibold mb-2">Ingresos Semana</h3>
            <p class="text-3xl font-bold text-white">${{ getTotalIngresosSemana() | number }}</p>
        </div>
        <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
            <h3 class="text-gray-400 text-sm font-semibold mb-2">Conductores Activos</h3>
            <p class="text-3xl font-bold text-white">{{ conductores.length }}</p>
        </div>
        <div class="bg-gray-800 p-6 rounded-xl border border-gray-700">
            <h3 class="text-gray-400 text-sm font-semibold mb-2">Pagos Pendientes</h3>
            <p class="text-3xl font-bold text-red-400">{{ getConductoresPendientes().length }}</p>
        </div>
     </div>
     
     <div class="text-center p-10 bg-gray-800/50 rounded-xl border border-dashed border-gray-700">
         <p class="text-gray-400">Vista detallada de reportes en construcci√≥n...</p>
     </div>
  </div>

  <!-- Vista TABLA (Default) -->
  <div *ngIf="!vistaReportes" class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden shadow-2xl">
      <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse">
              <thead>
                  <tr class="bg-gray-900/50 text-gray-400 text-sm uppercase border-b border-gray-700">
                      <th class="px-6 py-4 font-semibold">Usuario</th>
                      <th class="px-6 py-4 font-semibold">Rol</th>
                      <th class="px-6 py-4 font-semibold">Contacto</th>
                      <th class="px-6 py-4 font-semibold text-center">Estado</th>
                      <th class="px-6 py-4 font-semibold text-right">Acciones</th>
                  </tr>
              </thead>
              <tbody class="divide-y divide-gray-700">
                  <tr *ngFor="let usuario of usuarios" class="hover:bg-gray-700/50 transition duration-150">
                      <td class="px-6 py-4">
                          <div class="flex items-center gap-4">
                              <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-pink-500 flex items-center justify-center text-white font-bold text-sm shadow-md">
                                  {{ usuario.nombre.charAt(0) }}{{ usuario.apellido.charAt(0) }}
                              </div>
                              <div>
                                  <p class="font-bold text-white">{{ usuario.nombre }} {{ usuario.apellido }}</p>
                                  <p class="text-xs text-gray-400">CC: {{ usuario.cedula }}</p>
                              </div>
                          </div>
                      </td>
                      <td class="px-6 py-4">
                          <span [class]="'px-3 py-1 rounded-full text-xs font-semibold capitalize border ' + 
                              (usuario.rol === 'administrador' ? 'bg-purple-500/10 text-purple-400 border-purple-500/20' : 
                               (usuario.rol === 'conductor' ? 'bg-blue-500/10 text-blue-400 border-blue-500/20' : 
                                'bg-gray-700 text-gray-300 border-gray-600'))">
                              {{ usuario.rol }}
                          </span>
                      </td>
                      <td class="px-6 py-4">
                          <p class="text-sm text-gray-300">{{ usuario.telefono }}</p>
                          <p class="text-xs text-gray-500">{{ usuario.email }}</p>
                      </td>
                      <td class="px-6 py-4 text-center">
                          <div class="flex items-center justify-center gap-2">
                             <div [class]="'w-2 h-2 rounded-full ' + (usuario.activo ? 'bg-green-500' : 'bg-red-500')"></div>
                             <span [class]="'text-sm ' + (usuario.activo ? 'text-green-400' : 'text-red-400')">
                                 {{ usuario.activo ? 'Activo' : 'Inactivo' }}
                             </span>
                          </div>
                      </td>
                      <td class="px-6 py-4 text-right">
                          <div class="flex items-center justify-end gap-2">
                              <button (click)="editarUsuario(usuario)" 
                                  class="p-2 text-blue-400 hover:bg-blue-500/10 rounded-lg transition" title="Editar">
                                  ‚úèÔ∏è
                              </button>
                              <button (click)="eliminarUsuario(usuario._id!)" 
                                  class="p-2 text-red-400 hover:bg-red-500/10 rounded-lg transition" title="Eliminar">
                                  üóëÔ∏è
                              </button>
                          </div>
                      </td>
                  </tr>
                  
                  <tr *ngIf="usuarios.length === 0">
                      <td colspan="5" class="px-6 py-12 text-center text-gray-500">
                          No se encontraron usuarios registrados.
                      </td>
                  </tr>
              </tbody>
          </table>
      </div>
  </div>

</div>

<!-- Modal Usuario -->
<div *ngIf="mostrarModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4">
  <div class="bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl border border-gray-700 overflow-hidden transform transition-all">
      <div class="p-6 border-b border-gray-700 bg-gray-900/50 flex justify-between items-center">
          <h3 class="text-xl font-bold text-white">
              {{ modoEdicion ? '‚úèÔ∏è Editar Usuario' : 'üë§ Nuevo Usuario' }}
          </h3>
          <button (click)="cerrarModal()" class="text-gray-400 hover:text-white transition text-2xl">&times;</button>
      </div>

      <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                  <label class="block text-sm font-medium text-gray-400 mb-1">Nombre</label>
                  <input [(ngModel)]="nuevoUsuario.nombre" class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>
              <div>
                  <label class="block text-sm font-medium text-gray-400 mb-1">Apellido</label>
                  <input [(ngModel)]="nuevoUsuario.apellido" class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>
              <div>
                  <label class="block text-sm font-medium text-gray-400 mb-1">C√©dula</label>
                  <input type="number" [(ngModel)]="nuevoUsuario.cedula" class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>
              <div>
                  <label class="block text-sm font-medium text-gray-400 mb-1">Tel√©fono</label>
                  <input [(ngModel)]="nuevoUsuario.telefono" class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>
              <div class="md:col-span-2">
                  <label class="block text-sm font-medium text-gray-400 mb-1">Email</label>
                  <input type="email" [(ngModel)]="nuevoUsuario.email" class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none">
              </div>
              <div>
                  <label class="block text-sm font-medium text-gray-400 mb-1">Rol</label>
                  <select [(ngModel)]="nuevoUsuario.rol" class="w-full bg-gray-900 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none appearance-none">
                      <option value="empleado">üë∑ Empleado / Conductor</option>
                      <option value="administrador">üëë Administrador</option>
                      <option value="asesor">üëî Asesor</option>
                  </select>
              </div>
              <div class="flex items-end">
                  <label class="flex items-center gap-3 cursor-pointer">
                      <input type="checkbox" [(ngModel)]="nuevoUsuario.activo" class="w-5 h-5 rounded border-gray-600 bg-gray-900 text-blue-600 focus:ring-blue-500">
                      <span class="text-white font-medium">Usuario Activo</span>
                  </label>
              </div>
          </div>
      </div>

      <div class="p-6 border-t border-gray-700 bg-gray-900/30 flex justify-end gap-3">
          <button (click)="cerrarModal()" class="px-5 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-gray-700 transition">Cancelar</button>
          <button (click)="agregarUsuario()" 
                  class="px-5 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-medium shadow-lg shadow-blue-500/20 transition">
              {{ modoEdicion ? 'Actualizar' : 'Guardar' }}
          </button>
      </div>
  </div>
</div>
